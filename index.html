<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Lease vs Rent Fintech Decision Engine</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>

/* ---------- TYPOGRAPHY SYSTEM ---------- */

:root{
--bg:#f4f7fb;
--card:#ffffff;
--text:#0b1622;
--accent:#1f4e79;
--muted:#6c7a89;
--radius:14px;
}

body.dark{
--bg:#0b1622;
--card:#111e2c;
--text:#e6eef7;
--accent:#00d4ff;
--muted:#9fb3c8;
}

body{
margin:0;
font-family:Inter,Arial;
background:var(--bg);
color:var(--text);
padding:24px;
transition:.35s;
}

.container{max-width:1100px;margin:auto;}

h1{font-size:28px;text-align:center;margin-bottom:10px;}
h3{font-size:18px;margin-bottom:12px;}

.card{
background:var(--card);
border-radius:var(--radius);
padding:24px;
margin-bottom:24px;
box-shadow:0 8px 18px rgba(0,0,0,.06);
}

/* ---------- INPUT GRID ---------- */

.grid{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
gap:14px;
}

input{
padding:12px;
border-radius:10px;
border:1px solid #ccc;
background:transparent;
color:var(--text);
font-size:14px;
}

/* ---------- BUTTONS ---------- */

button{
background:var(--accent);
color:white;
border:none;
padding:12px;
border-radius:10px;
font-weight:600;
cursor:pointer;
margin-top:10px;
}

/* ---------- METRICS ---------- */

.metricLabel{
font-size:13px;
color:var(--muted);
margin-top:14px;
}

.metricValue{
font-size:22px;
font-weight:700;
margin-top:4px;
}

/* ---------- TOGGLE ---------- */

.toggleWrap{
display:flex;
justify-content:flex-end;
margin-bottom:14px;
}

.toggleBtn{
background:var(--accent);
color:white;
padding:8px 14px;
border-radius:20px;
font-size:13px;
cursor:pointer;
}

/* ---------- CONFIDENCE BAR ---------- */

.bar{
height:14px;
background:#ddd;
border-radius:10px;
overflow:hidden;
margin-top:12px;
}

.fill{
height:100%;
width:0%;
background:linear-gradient(90deg,#ff4d4d,#f1c40f,#2ecc71);
transition:width 1s ease;
}

.verdict{
font-size:20px;
font-weight:700;
text-align:center;
margin-top:14px;
}

</style>
</head>

<body>

<div class="container">

<div class="toggleWrap">
<div class="toggleBtn" onclick="toggleTheme()"> Dark Mode |  Light Mode</div>
</div>

<h1>Lease vs Rent Fintech Decision Engine</h1>

<div class="card">
<h3>Inputs</h3>

<div class="grid">
<input id="leaseAmount" class="currency" placeholder="Lease Amount">
<input id="loanAmount" class="currency" placeholder="Loan Amount">
<input id="loanRate" class="percent" placeholder="Loan Interest %">
<input id="loanTenure" placeholder="Loan Tenure Months">
<input id="leaseTenure" placeholder="Lease Tenure Months">
<input id="maintenance" class="currency" placeholder="Monthly Maintenance">
<input id="marketRent" class="currency" placeholder="Market Rent">
<input id="oppRate" class="percent" placeholder="Opportunity Cost %">
<input id="riskPremium" class="percent" placeholder="Risk Premium %">
</div>

<button onclick="runScenario('best')">Best Case</button>
<button onclick="runScenario('realistic')">Realistic Case</button>
<button onclick="runScenario('worst')">Worst Case</button>

<button onclick="downloadPDF()">Download Professional Report</button>

</div>

<div class="card">

<div id="results"></div>

<div id="verdict" class="verdict"></div>

<div class="metricLabel">Confidence Score</div>
<div class="bar"><div id="confidenceFill" class="fill"></div></div>

</div>

</div>

<script>

const $=id=>document.getElementById(id);
let lastResults={};

/* ---------- THEME ---------- */

function toggleTheme(){
document.body.classList.toggle("dark");
}

/* ---------- FORMAT ---------- */

function clean(v){return parseFloat((v||"").replace(/[,%\s,]/g,""))||0;}
function INR(n){return " "+Math.round(n||0).toLocaleString("en-IN");}
function PCT(n){return (n||0).toFixed(2)+"%";}

document.querySelectorAll(".currency").forEach(i=>{
i.addEventListener("blur",()=>{let v=clean(i.value);if(v)i.value=INR(v);});
});
document.querySelectorAll(".percent").forEach(i=>{
i.addEventListener("blur",()=>{let v=clean(i.value);if(v)i.value=PCT(v);});
});

/* ---------- ENGINE ---------- */

function emi(P,r,n){
if(r===0)return P/n;
return P*r*Math.pow(1+r,n)/(Math.pow(1+r,n)-1);
}

function runScenario(type){

let riskAdj=1,oppAdj=1;

if(type==="best"){riskAdj=.6;oppAdj=.8;}
if(type==="worst"){riskAdj=1.5;oppAdj=1.2;}

calculate(type,riskAdj,oppAdj);
}

function calculate(label,riskAdj,oppAdj){

const leaseAmount=clean($("leaseAmount").value);
const loanAmount=clean($("loanAmount").value);
const ownFunds=Math.max(0,leaseAmount-loanAmount);

const loanRate=(clean($("loanRate").value)/100)/12;
const loanTenure=clean($("loanTenure").value);
const leaseTenure=clean($("leaseTenure").value);

const maintenance=clean($("maintenance").value);
const marketRent=clean($("marketRent").value);

const oppRate=((clean($("oppRate").value)/100)/12)*oppAdj;
const riskPremium=(clean($("riskPremium").value)/100)*riskAdj;

const EMI=emi(loanAmount,loanRate,loanTenure);

const totalEconomic=EMI*loanTenure-loanAmount + ownFunds*oppRate*leaseTenure;
const riskRent=(totalEconomic/leaseTenure)*(1+riskPremium);

const monthlySavings=marketRent-riskRent;
const yearlySavings=monthlySavings*12;
const termSavings=monthlySavings*leaseTenure;

let score=(monthlySavings/marketRent)*100;
score=Math.max(0,Math.min(100,score));

let verdict=" Neutral Zone";
if(score>20) verdict=" Lease Is Winning";
if(score<5) verdict=" Rent Is Safer";

$("results").innerHTML=`

<div class="metricLabel">Own Funds Used</div>
<div class="metricValue">${INR(ownFunds)}</div>

<div class="metricLabel">EMI</div>
<div>${INR(EMI)}</div>

<div class="metricLabel">Risk Adjusted Rent</div>
<div>${INR(riskRent)}</div>

<div class="metricLabel">Monthly Savings</div>
<div class="metricValue">${INR(monthlySavings)}</div>

<div class="metricLabel">Yearly Savings</div>
<div>${INR(yearlySavings)}</div>

<div class="metricLabel">Lease Term Savings</div>
<div>${INR(termSavings)}</div>
`;

$("verdict").innerText=verdict+" ("+label.toUpperCase()+")";
$("confidenceFill").style.width=score+"%";

lastResults={EMI,riskRent,monthlySavings,yearlySavings,termSavings,label,verdict};

}

/* ---------- PROFESSIONAL REPORT ---------- */

async function downloadPDF(){

if(!lastResults.EMI){
alert("Run analysis first");
return;
}

const {jsPDF}=window.jspdf;
const doc=new jsPDF();

doc.setFontSize(18);
doc.text("Lease vs Rent Financial Decision Report",20,20);

doc.setFontSize(12);
doc.text("Executive Summary",20,40);
doc.text("Verdict: "+lastResults.verdict,20,50);
doc.text("Scenario: "+lastResults.label,20,60);

doc.text("Financial Overview",20,80);
doc.text("EMI: "+INR(lastResults.EMI),20,90);
doc.text("Risk Adjusted Rent: "+INR(lastResults.riskRent),20,100);

doc.text("Savings Analysis",20,120);
doc.text("Monthly Savings: "+INR(lastResults.monthlySavings),20,130);
doc.text("Yearly Savings: "+INR(lastResults.yearlySavings),20,140);
doc.text("Lease Term Savings: "+INR(lastResults.termSavings),20,150);

doc.text("Interpretation",20,170);
doc.text("Best, Realistic and Worst cases simulate different risk and opportunity assumptions to help you understand financial resilience.",20,180,{maxWidth:170});

doc.save("Lease_vs_Rent_Professional_Report.pdf");
}

</script>
</body>
</html>